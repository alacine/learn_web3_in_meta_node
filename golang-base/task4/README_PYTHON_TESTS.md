# Python HTTP API æµ‹è¯•å¥—ä»¶

è¿™æ˜¯ä¸€å¥—å®Œæ•´çš„Python HTTP APIæµ‹è¯•å·¥å…·ï¼Œç”¨äºæµ‹è¯•åšå®¢ç³»ç»Ÿçš„REST APIæ¥å£ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

ä½¿ç”¨ uv ç®¡ç†Pythonä¾èµ–ï¼š

```bash
# å®‰è£… uv (å¦‚æœè¿˜æ²¡æœ‰)
curl -LsSf https://astral.sh/uv/install.sh | sh

# å®‰è£…é¡¹ç›®ä¾èµ–
uv sync
```

### 2. å¯åŠ¨æœåŠ¡

ç¡®ä¿GoæœåŠ¡å™¨å’ŒMySQLæ•°æ®åº“æ­£åœ¨è¿è¡Œï¼š

```bash
# å¯åŠ¨MySQLæ•°æ®åº“
docker-compose up -d

# å¯åŠ¨GoæœåŠ¡å™¨
go run main.go
```

### 3. è¿è¡Œæµ‹è¯•

#### æ–¹å¼ä¸€ï¼šäº¤äº’å¼èœå•

```bash
uv run python run_tests.py
```

#### æ–¹å¼äºŒï¼šå‘½ä»¤è¡Œå‚æ•°

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
uv run run_tests.py --all

# è¿è¡Œç‰¹å®šæµ‹è¯•æ¨¡å—
uv run run_tests.py --user          # ç”¨æˆ·APIæµ‹è¯•
uv run run_tests.py --post          # æ–‡ç« APIæµ‹è¯•
uv run run_tests.py --comment       # è¯„è®ºAPIæµ‹è¯•
uv run run_tests.py --comprehensive # ç»¼åˆæµ‹è¯•

# è‡ªå®šä¹‰APIåœ°å€
uv run run_tests.py --all --base-url http://localhost:8080/api/v1
```

#### æ–¹å¼ä¸‰ï¼šç›´æ¥è¿è¡Œæµ‹è¯•æ¨¡å—

```bash
# è¿è¡Œå•ä¸ªæµ‹è¯•æ¨¡å—
uv run python -m tests.test_user_api
uv run python -m tests.test_post_api
uv run python -m tests.test_comment_api
uv run python -m tests.test_comprehensive

# æˆ–è€…ç›´æ¥æ‰§è¡Œæµ‹è¯•æ–‡ä»¶
uv run python tests/test_user_api.py
uv run python tests/test_post_api.py
uv run python tests/test_comment_api.py
uv run python tests/test_comprehensive.py
```

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ pyproject.toml              # é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ run_tests.py               # æµ‹è¯•è¿è¡Œå™¨
â”œâ”€â”€ README_PYTHON_TESTS.md     # è¯´æ˜æ–‡æ¡£
â””â”€â”€ tests/                     # æµ‹è¯•æ¨¡å—ç›®å½•
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ base_test.py           # åŸºç¡€æµ‹è¯•ç±»
    â”œâ”€â”€ test_user_api.py       # ç”¨æˆ·APIæµ‹è¯•
    â”œâ”€â”€ test_post_api.py       # æ–‡ç« APIæµ‹è¯•
    â”œâ”€â”€ test_comment_api.py    # è¯„è®ºAPIæµ‹è¯•
    â””â”€â”€ test_comprehensive.py  # ç»¼åˆæµ‹è¯•
```

## ğŸ§ª æµ‹è¯•æ¨¡å—è¯´æ˜

### 1. ç”¨æˆ·APIæµ‹è¯• (`test_user_api.py`)

æµ‹è¯•åŠŸèƒ½ï¼š
- âœ… ç”¨æˆ·æ³¨å†Œï¼ˆæ­£å¸¸å’Œå¼‚å¸¸æƒ…å†µï¼‰
- âœ… ç”¨æˆ·ç™»å½•éªŒè¯
- âœ… è·å–ç”¨æˆ·ä¿¡æ¯
- âœ… æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- âœ… åˆ é™¤ç”¨æˆ·
- âœ… è¾¹ç•Œæ¡ä»¶æµ‹è¯•

### 2. æ–‡ç« APIæµ‹è¯• (`test_post_api.py`)

æµ‹è¯•åŠŸèƒ½ï¼š
- âœ… æ–‡ç« åˆ›å»ºï¼ˆåŒ…æ‹¬é•¿å†…å®¹ï¼‰
- âœ… æ–‡ç« è·å–å’ŒæŸ¥è¯¢
- âœ… æ–‡ç« æ›´æ–°æ“ä½œ
- âœ… æ–‡ç« åˆ é™¤åŠŸèƒ½
- âœ… æ— æ•ˆæ•°æ®å¤„ç†
- âœ… ç‰¹æ®Šå­—ç¬¦æ”¯æŒ

### 3. è¯„è®ºAPIæµ‹è¯• (`test_comment_api.py`)

æµ‹è¯•åŠŸèƒ½ï¼š
- âœ… è¯„è®ºåˆ›å»ºå’Œç®¡ç†
- âœ… å¤šè¯­è¨€å’Œç‰¹æ®Šå­—ç¬¦
- âœ… é•¿è¯„è®ºå†…å®¹æ”¯æŒ
- âœ… è¯„è®ºæ›´æ–°å’Œåˆ é™¤
- âœ… å…³è”æ•°æ®éªŒè¯

### 4. ç»¼åˆæµ‹è¯• (`test_comprehensive.py`)

æ¨¡æ‹ŸçœŸå®åœºæ™¯ï¼š
- ğŸ‘¥ å¤šç”¨æˆ·æ³¨å†Œå’Œè®¤è¯
- ğŸ“ åšå®¢æ–‡ç« åˆ›å»ºå’Œå‘å¸ƒ
- ğŸ’¬ ç”¨æˆ·äº’åŠ¨å’Œè¯„è®º
- âœï¸ å†…å®¹æ›´æ–°å’Œç»´æŠ¤
- ğŸ” æ•°æ®æ£€ç´¢å’ŒéªŒè¯
- âš ï¸ é”™è¯¯åœºæ™¯å¤„ç†
- ğŸ“Š æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ

## ğŸ¨ æµ‹è¯•ç‰¹æ€§

### å½©è‰²è¾“å‡º

ä½¿ç”¨ `colorama` åº“æä¾›å½©è‰²ç»ˆç«¯è¾“å‡ºï¼š
- ğŸŸ¢ æˆåŠŸæ“ä½œ - ç»¿è‰²
- ğŸ”´ é”™è¯¯ä¿¡æ¯ - çº¢è‰²  
- ğŸŸ¡ è­¦å‘Šä¿¡æ¯ - é»„è‰²
- ğŸ”µ æ™®é€šä¿¡æ¯ - è“è‰²

### è¯¦ç»†æ—¥å¿—

æ¯ä¸ªHTTPè¯·æ±‚éƒ½ä¼šæ˜¾ç¤ºï¼š
- è¯·æ±‚æ–¹æ³•å’ŒURL
- è¯·æ±‚æ•°æ®ï¼ˆJSONæ ¼å¼ï¼‰
- å“åº”çŠ¶æ€ç 
- å“åº”æ•°æ®ï¼ˆæ ¼å¼åŒ–æ˜¾ç¤ºï¼‰

### è‡ªåŠ¨æ¸…ç†

æµ‹è¯•å®Œæˆåè‡ªåŠ¨æ¸…ç†åˆ›å»ºçš„æµ‹è¯•æ•°æ®ï¼Œç¡®ä¿æ•°æ®åº“çš„å¹²å‡€çŠ¶æ€ã€‚

### é”™è¯¯å¤„ç†

å®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼š
- ç½‘ç»œè¿æ¥é”™è¯¯
- APIå“åº”é”™è¯¯
- æ•°æ®è§£æé”™è¯¯
- æµ‹è¯•æ‰§è¡Œå¼‚å¸¸

## ğŸ”§ é…ç½®é€‰é¡¹

### åŸºç¡€é…ç½®

å¯ä»¥é€šè¿‡ä¿®æ”¹ `base_test.py` ä¸­çš„ `BaseAPITest` ç±»æ¥è°ƒæ•´ï¼š

```python
class BaseAPITest:
    def __init__(self, base_url: str = "http://localhost:8000/api/v1"):
        self.base_url = base_url
        # å…¶ä»–é…ç½®...
```

### è¶…æ—¶è®¾ç½®

HTTPè¯·æ±‚è¶…æ—¶å¯ä»¥åœ¨ä¼šè¯ä¸­é…ç½®ï¼š

```python
self.session.timeout = 30  # 30ç§’è¶…æ—¶
```

## ğŸ“Š æµ‹è¯•æŠ¥å‘Š

ç»¼åˆæµ‹è¯•ä¼šç”Ÿæˆè¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Šï¼ŒåŒ…æ‹¬ï¼š
- æµ‹è¯•æ•°æ®ç»Ÿè®¡
- ç”¨æˆ·å’Œå†…å®¹ä¿¡æ¯
- äº¤äº’è¡Œä¸ºåˆ†æ
- æ‰§è¡Œç»“æœæ±‡æ€»

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æœåŠ¡å™¨è¿æ¥å¤±è´¥**
   ```
   âŒ æœåŠ¡å™¨æœªè¿è¡Œï¼è¯·å…ˆå¯åŠ¨æœåŠ¡å™¨: go run main.go
   ```
   è§£å†³ï¼šç¡®ä¿GoæœåŠ¡å™¨åœ¨8000ç«¯å£è¿è¡Œ

2. **ä¾èµ–ç¼ºå¤±**
   ```
   âŒ ç¼ºå°‘ä¾èµ–: No module named 'requests'
   ```
   è§£å†³ï¼šè¿è¡Œ `uv sync` å®‰è£…ä¾èµ–

3. **æ•°æ®åº“è¿æ¥é”™è¯¯**
   ```
   æ•°æ®åº“è¿æ¥å¤±è´¥
   ```
   è§£å†³ï¼šç¡®ä¿MySQLå®¹å™¨è¿è¡Œ `docker-compose up -d`

4. **ç«¯å£å†²çª**
   ```
   è¿æ¥è¢«æ‹’ç»
   ```
   è§£å†³ï¼šæ£€æŸ¥ç«¯å£8000æ˜¯å¦è¢«å ç”¨ï¼Œæˆ–ä¿®æ”¹base_url

### è°ƒè¯•æ¨¡å¼

å¦‚éœ€æ›´è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼Œå¯ä»¥åœ¨æµ‹è¯•ä»£ç ä¸­æ·»åŠ ï¼š

```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

## ğŸš€ æ‰©å±•å¼€å‘

### æ·»åŠ æ–°çš„æµ‹è¯•æ¨¡å—

1. ç»§æ‰¿ `BaseAPITest` ç±»
2. å®ç° `run_test_suite()` æ–¹æ³•
3. æ·»åŠ å…·ä½“çš„æµ‹è¯•æ–¹æ³•
4. åœ¨ `run_tests.py` ä¸­æ³¨å†Œæ–°æ¨¡å—

ç¤ºä¾‹ï¼š

```python
from tests.base_test import BaseAPITest

class NewAPITest(BaseAPITest):
    def run_test_suite(self):
        self.print_test_header("æ–°åŠŸèƒ½æµ‹è¯•")
        # å®ç°æµ‹è¯•é€»è¾‘
        return True
```

### è‡ªå®šä¹‰æ–­è¨€

å¯ä»¥æ‰©å±•åŸºç±»æ·»åŠ æ›´å¤šæ–­è¨€æ–¹æ³•ï¼š

```python
def assert_user_data(self, response, expected_username):
    data = response.json()
    actual_username = data.get('data', {}).get('username')
    assert actual_username == expected_username
```

## ğŸ“ æœ€ä½³å®è·µ

1. **æµ‹è¯•éš”ç¦»**: æ¯ä¸ªæµ‹è¯•éƒ½åº”è¯¥æ˜¯ç‹¬ç«‹çš„ï¼Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•çš„ç»“æœ
2. **æ•°æ®æ¸…ç†**: æµ‹è¯•å®Œæˆåæ¸…ç†åˆ›å»ºçš„æ•°æ®
3. **é”™è¯¯å¤„ç†**: å¦¥å–„å¤„ç†å„ç§å¼‚å¸¸æƒ…å†µ
4. **å¯è¯»æ€§**: ä½¿ç”¨æè¿°æ€§çš„æµ‹è¯•åç§°å’Œæ—¥å¿—ä¿¡æ¯
5. **å‚æ•°åŒ–**: å¯¹äºç›¸ä¼¼çš„æµ‹è¯•ï¼Œä½¿ç”¨å‚æ•°åŒ–å‡å°‘é‡å¤ä»£ç 

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Pull Requestæ¥æ”¹è¿›æµ‹è¯•å¥—ä»¶ï¼š

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æ·»åŠ æµ‹è¯•ç”¨ä¾‹
4. ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
5. æäº¤PR

---

ğŸ“§ å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤Issueæˆ–PRï¼
